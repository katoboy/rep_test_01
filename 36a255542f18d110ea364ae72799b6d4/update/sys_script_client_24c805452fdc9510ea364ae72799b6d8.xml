<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="deb7691c2f58d110ea364ae72799b62a" table="sys_script_client">
    <sys_script_client action="INSERT_OR_UPDATE">
        <active>true</active>
        <applies_extended>false</applies_extended>
        <condition/>
        <description>入力内容をもとにサーバ払出申請基本情報テーブルにレコードを作成する。&#13;
またその際のsys_idをサーバ払出申請レコードの参照フィールドに設定する。</description>
        <field/>
        <global>true</global>
        <isolate_script>true</isolate_script>
        <messages/>
        <name>camdev_CreateServerRequestBase_OnSubmit</name>
        <order/>
        <script><![CDATA[function onSubmit() {
   //Type appropriate comment here, and begin script below
   
	if(!g_form.isNewRecord()){//新規レコードの場合のみ実行する
		return;
	}
	
	//必須項目に値が入っている場合、Mandatory設定を外す
	var environment_classification = g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_environment_classification');
	var usage_system = g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_usage_system');
	var sub_system = g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_sub_system');
	var classification = g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_classification');
	var server_type = g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_server_type');
	var new_network = g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_new_network');
	var network_cable_connection = g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_network_cable_connection');
	var manager = g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_manager');

	
	if(environment_classification){
		g_form.setMandatory('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_environment_classification', false);
	}
	
	if(usage_system){
		g_form.setMandatory('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_usage_system', false);
	}
	
	if(sub_system){
		g_form.setMandatory('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_sub_system', false);
	}
	
	if(classification){
		g_form.setMandatory('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_classification', false);
	}
	
	if(server_type){
		g_form.setMandatory('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_server_type', false);
	}
	
	if(new_network){
		g_form.setMandatory('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_new_network', false);
	}
	
	if(network_cable_connection){
		g_form.setMandatory('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_network_cable_connection', false);
	}
	
	if(manager){
		g_form.setMandatory('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_manager', false);
	}
	
	if (g_scratchpad.isFormValid)//2回目実行時はそのまま終了
        return true;
	
	var ga = new GlideAjax('camdev_CreateServerRequestBase');
	ga.addParam('sysparm_name', 'CreateRecord');
	ga.addParam('sysparm_sysid', g_form.getUniqueValue());
	ga.addParam('sysparm_number', g_form.getValue('number'));
	ga.addParam('sysparm_request_owner', g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_request_owner'));
	ga.addParam('sysparm_environment_classification', environment_classification);
	ga.addParam('sysparm_usage_system', usage_system);
	ga.addParam('sysparm_sub_system', sub_system);
	ga.addParam('sysparm_other_entries', g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_other_entries'));
	ga.addParam('sysparm_request_status', g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_request_status'));
	ga.addParam('sysparm_request_date', g_form.getValue('u_74_external_ref.ref_x_nttm8_campus_dev_01_server_request_base.u_01_request_date'));
	ga.addParam('sysparm_classification', classification);
	ga.addParam('sysparm_server_type', server_type);
	ga.addParam('sysparm_new_network', new_network);
	ga.addParam('sysparm_network_cable_connection', network_cable_connection);
	ga.addParam('sysparm_manager', manager);
	ga.getXMLAnswer(setAnswer);
	return false;//送信を一旦中断する
	
	function setAnswer(answer) {
		g_form.setValue('u_74_external_ref',answer);//サーバ払出申請基本情報テーブルを参照するフィールドに参照先を設定
		var actionName = g_form.getActionName();
		g_scratchpad.isFormValid = true;
		g_form.submit(actionName);//再度送信処理を行う
	}
   
}]]></script>
        <sys_class_name>sys_script_client</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-06-23 10:02:51</sys_created_on>
        <sys_domain>deb7691c2f58d110ea364ae72799b62a</sys_domain>
        <sys_domain_path>!!!/!!,/!!!/!!!/</sys_domain_path>
        <sys_id>24c805452fdc9510ea364ae72799b6d8</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>camdev_CreateServerRequestBase_OnSubmit</sys_name>
        <sys_overrides/>
        <sys_package display_value="CampusDevApplication" source="x_761427_campusdev">36a255542f18d110ea364ae72799b6d4</sys_package>
        <sys_policy/>
        <sys_scope display_value="CampusDevApplication">36a255542f18d110ea364ae72799b6d4</sys_scope>
        <sys_update_name>sys_script_client_24c805452fdc9510ea364ae72799b6d8</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2022-06-23 10:02:51</sys_updated_on>
        <table>x_761427_campusdev_08_server_request</table>
        <type>onSubmit</type>
        <ui_type>0</ui_type>
        <view/>
    </sys_script_client>
</record_update>
